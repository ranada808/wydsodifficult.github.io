<!--
 * WYD - blank.html template
 * @version v0.17.05.31
 * Copyright (c) 2017 WYD
 * NOTE: Login redirect is commented out
 -->
 <!DOCTYPE html>
<html lang="en">

<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="WYD - What'd You Do?">
    <meta name="author" content="Higashi">
    <meta name="keyword" content="WYD, What'd You Do?, Whatd You Do">
    <link rel="shortcut icon" href="img/WYD_logo.png">

    <title>WYD-Operations Reports</title>

    <!-- Icons -->
    <link href="css/font-awesome.min.css" rel="stylesheet">
    <link href="css/simple-line-icons.css" rel="stylesheet">

    <!-- Premium Icons -->
    <link href="css/glyphicons.css" rel="stylesheet">
    <link href="css/glyphicons-filetypes.css" rel="stylesheet">
    <link href="css/glyphicons-social.css" rel="stylesheet">
    
    <!-- Main styles for this application -->
    <link href="css/style.css" rel="stylesheet">
    <link href="css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="css/responsive.bootstrap4.min.js" rel="stylesheet">
    <link rel='stylesheet' type='text/css' href='http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css'/>
    
    <script src="https://www.gstatic.com/firebasejs/4.1.2/firebase.js"></script>
    <script src="js/fbinit.js"></script>

</head>

<!-- BODY options, add following classes to body to change options

// Sidebar options
1. '.sidebar-fixed'					- Fixed Sidebar
2. '.sidebar-hidden'				- Hidden Sidebar
3. '.sidebar-off-canvas'		- Off Canvas Sidebar
4. '.sidebar-compact'				- Compact Sidebar Navigation (Only icons)

-->

<body class="app header-fixed sidebar-fixed">
    
    <!-- Navigation Header for Operations>     
    <header class="app-header navbar">
        <button class="navbar-toggler mobile-sidebar-toggler hidden-lg-up" type="button">≡</button>
        <span class="nav navbar-nav py-1 px-2 hidden-lg-up">
            <i class="fa fa-cubes"></i>OPERATIONS
        </span>
        <a class="navbar-brand" href="operations-dashboard.html"></a>
        <ul class="nav navbar-nav hidden-md-down b-r-1">
            <li class="nav-item">
                <a class="nav-link navbar-toggler sidebar-toggler" href="#">≡</a>
            </li>

        </ul>
        <span class="nav navbar-nav float-left py-1 px-2 hidden-md-down">
            <i class="fa fa-cubes"></i>OPERATIONS
        </span>
        <span class="nav navbar-toggler-right float-right hidden-md-down">
            <a id="logout-sidebar" class="py-1 px-2" href="#" ><i class="fa fa-sign-out"></i>Logout</a>
        </span>

    </header-->
    
    <!-- Navigation Header for employees -->
    <header class="app-header navbar">
        <button class="navbar-toggler mobile-sidebar-toggler hidden-lg-up" type="button">≡</button>
        <span class="nav navbar-nav py-1 px-2 hidden-lg-up">
            <i class="fa fa-paw"></i>EMPLOYEES
        </span>
        <a class="navbar-brand" href="employees-dashboard.html"></a>
        <ul class="nav navbar-nav hidden-md-down b-r-1">
            <li class="nav-item">
                <a class="nav-link navbar-toggler sidebar-toggler" href="#">≡</a>
            </li>

        </ul>
        <span class="nav navbar-nav float-left py-1 px-2 hidden-md-down">
            <i class="fa fa-cube"></i>EMPLOYEES
        </span>
        <span class="nav navbar-toggler-right float-right hidden-md-down">
            <a id="logout-sidebar" class="py-1 px-2" href="#"><i class="fa fa-sign-out"></i>Logout</a>
        </span>

    </header>

    <div class="app-body">
        <div class="sidebar">

            <div class="sidebar-header">
                <div>
                   <br>
                    <strong id="full-name">SHANIQUA JONES</strong>
                </div>
                <div class="text-muted">
                    <small id="job-title">Seated User</small>
                </div>
            </div>

            <nav class="sidebar-nav">
                <!-- This nav is hidden if employees-navbar is loaded -->
                <!--ul class="nav" id="operations-sidebar">
                    <li class="divider"></li>
                    <li class="nav-item">
                        <a class="nav-link" href="employees-dashboard.html"> Switch to Employee View</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="operations-dashboard.html">
                        <i class="icon-speedometer"></i>DASHBOARD</a>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item nav-dropdown">
                        <a class="nav-link nav-dropdown-toggle" href="#"><i class="icon-notebook"></i>REPORTS</a>
                        <ul class="nav-dropdown-items">
                            <li class="nav-item">
                                <a class="nav-link" href="operations-reports-new.html"><i class="icon-doc"></i>  New</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="operations-reports.html"><i class="icon-docs"></i>  View</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="operations-reports-templates.html"><i class="icon-wrench"></i>  Templates</a>
                            </li>
                        </ul>
                    </li>
                    <li class="nav-item nav-dropdown">
                        <a class="nav-link nav-dropdown-toggle" href="#"><i class="icon-home"></i>HOUSEKEEPING</a>
                        <ul class="nav-dropdown-items">
                            <li class="nav-item">
                                <a class="nav-link" href="operations-jobs.html"><i class="icon-basket-loaded"></i>  Jobs</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="operations-seats.html"><i class="icon-puzzle"></i>  Seats</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="operations-company.html"><i class="icon-picture"></i>  Company Profile</a>
                            </li>
                        </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item">
                        <a class="nav-link" href="settings.html"><i class="icon-settings"></i>SETTINGS</a>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item">
                        <a id="logout" class="nav-link" href="#"><i class="icon-logout"></i>LOGOUT</a>
                    </li>
                    <li class="divider"></li>
                </ul-->
                
                <!-- This nav is hidden if operations-navbar is loaded -->
                <ul class="nav" id="employees-sidebar">
                   
                    <li class="nav-item">
                        <a class="nav-link" href="operations-dashboard.html"> Switch to Operations View</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="employees-dashboard.html">
                        <i class="icon-speedometer"></i>DASHBOARD</a>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item nav-dropdown">
                        <a class="nav-link nav-dropdown-toggle" href="#"><i class="icon-notebook"></i>REPORTS</a>
                        <ul class="nav-dropdown-items">
                            <li class="nav-item">
                                <a class="nav-link" href="employees-reports-new.html"><i class="icon-doc"></i>  New</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="employees-reports-mine.html"><i class="icon-book-open"></i>  View Mine</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="employees-reports.html"><i class="icon-docs"></i>  View All</a>
                            </li>
                        </ul>
                    </li>
                   <li class="nav-item">
                        <a class="nav-link" href="employees-profile.html">
                        <i class="icon-user"></i>MY PROFILE</a>
                    </li>
                    <li class="nav-item nav-dropdown">
                        <a class="nav-link nav-dropdown-toggle" href="#"><i class="icon-home"></i>OPERATIONAL</a>
                        <ul class="nav-dropdown-items">
                            <li class="nav-item">
                                <a class="nav-link" href="employees-jobs.html"><i class="icon-basket-loaded"></i>  Jobs</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="employees-list.html"><i class="icon-puzzle"></i>  Employee List</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="employees-company.html"><i class="icon-picture"></i>  Company Profile</a>
                            </li>
                        </ul>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item">
                        <a class="nav-link" href="settings.html"><i class="icon-settings"></i>SETTINGS</a>
                    </li>
                    <li class="divider"></li>
                    <li class="nav-item">
                        <a id="logout" class="nav-link" href="#"><i class="icon-logout"></i>LOGOUT</a>
                    </li>
                    <li class="divider"></li>
                </ul>
            </nav>
        </div>

        <!-- Main content -->
        <main class="main">

            <div class="container-fluid">

                <div class="animated spin"> <!-- fadeIn -->
                    <h1>Your Reports</h1>
                    <hr>
                    <div id="view-card" style="display:none" class="col-sm">
                        <div class="card card-accent-primary">
                            <div class="card-header">
                                Report Type: <b id="view-report"></b>
                            </div>
                            <div class="card-block">
                                <h5>Job Info</h5>
                                <hr>
                                <label for="view-report-job-name">Job Name</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="icon-briefcase"></i></span>
                                    <input readonly class="form-control"  id="view-report-job-name"></input>
                                </div>
                                <label for="view-report-job-num">Job Number</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon">#</span>
                                    <input readonly class="form-control"  id="view-report-job-num"></input>
                                </div>
                                <label for="view-report-date">Date</label>
                                <div class="input-group mb-1 date">
                                    <span class="input-group-addon"><i class="icon-calendar"></i></span>
                                    <input readonly id="view-report-date" type="datetime" class="form-control"></input>
                                </div>
                                <label for="view-report-time-start">Start Time</label>
                                <div class="input-group mb-1 date">
                                    <span class="input-group-addon"><i class="icon-clock"></i></span>
                                    <input readonly type="datetime" class="form-control" id="view-report-time-start"/>
                                    <span class="input-group-addon" id="view-report-time-set" style="display:none">
                                        <i class="fa fa-hourglass-start"  onfocus="blur();"></i>Click Me!
                                    </span>
                                </div>
                                <label for="view-report-time-end">End Time</label>
                                <div class="input-group mb-1 date">
                                    <span class="input-group-addon"><i class="icon-clock"></i></span>
                                    <input readonly type="datetime" class="form-control" id="view-report-time-end"/>
                                    <span class="input-group-addon" id="view-report-time-set" style="display:none">
                                        <i class="fa fa-hourglass-end"  onfocus="blur();"></i>Click Me!
                                    </span>
                                </div>
                                <label for="view-report-time-total">Total Time (Auto-Calculated)</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="icon-calculator"></i></span>
                                    <input readonly type="text" class="form-control"  id="view-report-time-total" value="8" readonly></input>
                                </div>
                                <label for="view-report-contractor">Job Contractor (Uneditable)</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="icon-wrench"></i></span>
                                    <input readonly class="form-control"  id="view-report-contractor" placeholder="Contractor"></input>
                                </div>
                                <label for="view-report-foreman">Foreman</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="fa fa-fort-awesome"></i></span>
                                    <input readonly class="form-control"  id="view-report-foreman" placeholder="Foreman"></input>
                                </div>
                                <!-- Input Fields for DPR -->
                                <div id="div-view-report-dpr" style="display:none">
                                    <label for="view-report-dpr-lunch">Lunch Length (Minutes)</label>
                                    <div class="input-group mb-1">
                                        <span class="input-group-addon"><i class="fa fa-clock-o"></i></span>
                                        <input readonly type="number" id="view-report-dpr-lunch" placeholder="Minutes" class="form-control">
                                        </input>
                                    </div>
                                    <label for="view-report-dpr-techs" id="view-report-dpr-techs-label" style="display:none">Select Employees</label>
                                    <div class="input-group mb-1" id=view-report-dpr-techs-div style="display:none">
                                        <span class="input-group-addon"><i class="fa fa-users"></i></span>
                                        <select id="view-report-dpr-techs" placeholder="Select Your Employees" class="form-control select2-multiple" multiple="multiple">
                                        </select>
                                    </div>
                                    <button id="view-report-tech-hours" type="button" style="display:none" class="btn btn-primary" onclick="reportSetTechHours()">Set Hours for Chosen Employees</button>
                                    <div id = "view-report-dpr-lunch">
                                    </div>
                                    <div id = "view-report-dpr-techs-hours">
                                    </div>
                                    <div id="view-report-dpr-materials">
                                    </div>
                                    <div id = "view-report-dpr-hidden-materials">
                                        <input id="view-report-dpr-materials-count" style="display:none" value=0></input>
                                    </div>  
                                    <button style="display:none" type="button" class="btn btn-primary" onclick="newDPRLine('materials')">Add Another Materials Line</button>
                                    <div id = "view-report-dpr-performed">
                                    </div>
                                    <div id = "view-report-dpr-hidden-performed">
                                        <input id="view-report-dpr-performed-count" style="display:none" value=0></input>
                                    </div>
                                    <button  style="display:none" type="button" class="btn btn-primary mb-1" onclick="newDPRLine('performed')">Add Another Work Performed Line</button>
                                    <div id = "view-report-dpr-tasks">
                                    </div>
                                    <div id = "view-report-dpr-hidden-tasks">
                                        <input id="view-report-dpr-tasks-count" style="display:none" value=0></input>
                                    </div>  
                                    <button  style="display:none" type="button" class="btn btn-primary mb-1" onclick="newDPRLine('tasks')">Add Another Tasks Line</button>
                                </div>
                                <label for="view-report-iqr">Issues / Questions / Remarks</label>
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="icon-emotsmile"></i></span>
                                    <textarea class="form-control" readonly id="view-report-iqr" placeholder="Any Issues Should Be Reported IMMEDIATELY"></textarea>
                                </div>
                                <hr>
                                <hr>
                                <div id="div-view-report-lunch" style="display:none">
                                    <label for="view-report-lunch">Lunch Length (Minutes)</label>
                                    <div class="input-group mb-1">
                                        <span class="input-group-addon"><i class="fa fa-clock-o"></i></span>
                                        <input readonly type="number" id="view-report-lunch" placeholder="Minutes" class="form-control">
                                        </input>
                                    </div>
                                </div>
                                <div id="view-report-fields">

                                </div>
                               <div id="loading" class="sk-cube-grid" style="display:none">
                                    <div class="sk-cube sk-cube1"></div>
                                    <div class="sk-cube sk-cube2"></div>
                                    <div class="sk-cube sk-cube3"></div>
                                    <div class="sk-cube sk-cube4"></div>
                                    <div class="sk-cube sk-cube5"></div>
                                    <div class="sk-cube sk-cube6"></div>
                                    <div class="sk-cube sk-cube7"></div>
                                    <div class="sk-cube sk-cube8"></div>
                                    <div class="sk-cube sk-cube9"></div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <input id="view-hidden-id" style="display:none"></input>
                                <div class="row">
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-view-close" class="btn btn-info float-center">Close View</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-view-download" type="button" class="btn btn-success">Download</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button style="display:none" id="button-view-edit" type="button" class="btn btn-warning">Edit</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-view-delete" type="button" class="btn btn-danger">Delete</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <div class="col-sm">
                        <div class="card card-accecnt-info">
                            <div class="card-header" data-toggle="collapse" href='#collapseSearch'>
                                 <span><i class="fa fa-search"></i></span><b>Search All Reports By Category (CASE SENSITIVE)</b>
                            </div>
                            <div class="card-block collapse" id="collapseSearch">
                                <div class="input-group mb-1">
                                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                                    <input id="view-search" class="form-control" type="text" placeholder="What are you looking for?">
                                    </input>
                                </div>
                                <div class="row">
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-type" class="btn btn-block btn-info">Report Type</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-num" class="btn btn-block btn-info" >Job Number</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-by" class="btn btn-block btn-info">Submitted By</button>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col mb-1">
                                        <div class="input-group">
                                            <span class="input-group-addon"><i class="icon-calendar"></i></span>
                                            <input readonly class="form-control" id="input-search-date" placeholder="Click Me To Select A Date"></input>
                                            <input id="input-search-date-alt" style="display:none">
                                        </input>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-date-report" class="btn btn-block btn-info">Search By Report Date</button>
                                    </div>
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-date-submitted" class="btn btn-block btn-info">Search By Submitted Date</button>
                                    </div>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="col" style="margin-bottom:4px">
                                        <button id="button-search-normal" class="btn btn-block btn-primary">Reshow 25 Most Recent</button>
                                    </div>
                                </div>
                                <div style="display:none">
                                    <input id="view-search-last-input"></input>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="card card-accent-primary">
                            <div class="card-header">
                                Viewing: <b id="view-viewing">25 Most Recent</b>
                            </div>
                            <div class="card-block">
                                Show/Hide: <a href='#' class="toggle-vis" data-column="0">Report Date/Time</a> - <a  href='#' class="toggle-vis" data-column="1">Type</a> - <a href='#'  class="toggle-vis" data-column="2">Job #</a> - <a  href='#' class="toggle-vis" data-column="3">Submitted Date</a> - <a  href='#' class="toggle-vis" data-column="4">Submitted By</a>
                                <table class="table table-striped datatable table-bordered table-hover display nowrap dt-responsive collapsed" id="view-table" cellspace="0" width="100%">
                                    <thead>
                                        <tr>
                                            <th>Report Date/Time</th>
                                            <th>Type</th>
                                            <th>Job Number</th>
                                            <th>Submitted Date</th>
                                            <th>Submitted By</th>
                                            <!-- Uncomment if button wanted
                                            <th data-priority="1">Actions</th-->
                                        </tr>
                                    </thead> 
                                </table>
                            </div>
                            <div class="card-footer">
                                <button id="button-view-increase" class="btn btn-primary float-right">Increase by 25</button>
                                <button id="button-view-increase-type" class="btn btn-primary float-right" style="display:none">Increase Type Search by 25</button>
                                <button id="button-view-increase-num" class="btn btn-primary float-right" style="display:none">Increase Job Number Search by 25</button>
                                <button id="button-view-increase-date" class="btn btn-primary float-right" style="display:none">Increase Date Search by 25</button>
                                <button id="button-view-increase-by" class="btn btn-primary float-right" style="display:none">Increase Submitted By Search by 25</button>
                                <input id="view-search-count" value=25 style="display:none"></input>
                                <input id="view-search-last" style="display:none"></input>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- /.conainer-fluid -->
        </main>

    </div>
    
    <div id="footer"></div>

    <!-- Load jquery for navs and footer -->
    <script src="js/libs/jquery.min.js"></script>
    
    <!-- Bootstrap and necessary plugins -->
    <script src="js/libs/tether.min.js"></script>
    <script src="js/libs/bootstrap.min.js"></script>
    <script src="js/libs/pace.min.js"></script>
    <script src="js/libs/moment.js"></script>
    <script src="js/libs/jspdf.debug.js"></script>
    <script src="js/libs/jspdf.plugin.autotable.js"></script>


    <!-- Plugins and scripts required by all views -->
    <script src="js/libs/Chart.min.js"></script>
    <script src="js/libs/toastr.min.js"></script>
    <script src="js/libs/jquery.dataTables.min.js"></script>
    <script src="js/libs/dataTables.bootstrap4.min.js"></script>
    <script src="js/libs/dataTables.responsive.min.js"></script>
    
    <!-- Main scripts -->
    <script src="js/app.js"></script>
    <script src="js/jstopdf.js"></script>
    
    <!-- Custom scripts required by this view -->
    <script src="js/views/tables.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>
    <script src="js/libs/datetime-moment.js"></script>
    
    <!-- Comment out unneeded navbars -->
    <script>
        $(document).ready(function () {
            $("#footer").load("footer.html");
            //$("#navbar").load("god-navbar.html");
            
            //document.getElementById("employees-sidebar").style.display = "none";
            //document.getElementById("operations-sidebar").style.display = "none";
            if(localStorage["WYDuserNameFull"]!=null){
                document.getElementById("full-name").innerHTML = localStorage["WYDuserNameFull"];
                document.getElementById("job-title").innerHTML = localStorage["WYDuserJobTitle"];
            }
            
            // Make DataTable sortable by Report Date
            $.fn.dataTable.moment('MM/DD/YYYY h:mm A');
            
            // Initialize data table
            $('#view-table').DataTable().destroy();
            var dataTable = $('#view-table').DataTable({
                autoWidth: false,
                columnDefs: [
                    //{
                        //"data":null
                        // Uncomment if button wanted
                        /*,
                        "defaultContent": "<button class='btn btn-primary'>View</button>",
                        "targets": -1
                        */
                    //},
                    {className: "desktop tablet-l tablet-p mobile-l mobile-p", targets: 0}, // Type
                    {className: "desktop tablet-l tablet-p mobile-l mobile-p", targets: 1}, // Job
                    {className: "desktop tablet-l tablet-p mobile-l mobile-p", targets: 2}, // Submitted Date
                    {className: "desktop tablet-l tablet-p mobile-l mobile-p", targets: 3}, // Report Date
                    {className: "desktop tablet-l tablet-p mobile-l mobile-p", targets: 4}, // Submitted By
                    
                ]
            });
            // Hide Submitted Date Column
            dataTable.column(3).visible(false);
            
            // Toggle Visibility of a Column
            $('a.toggle-vis').on( 'click', function (e) {
                e.preventDefault();

                // Get the column API object
                var column = dataTable.column( $(this).attr('data-column') );

                // Toggle the visibility
                column.visible( !column.visible() );
            } );
            
            // Functions for loading reports
            if(localStorage["WYDuserAccess"] /*==*/ > 6) {
                document.getElementById("view-table").setAttribute('style', 'display:none');
                document.getElementById("button-view-increase").setAttribute('style', 'display:none');
            }
            else {
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByKey().limitToLast(25).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                        dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                        document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = (dataTable.rows().count()) + " Most Recent";
                    dataTable.order([0, 'dec']).draw();
                });
                //dataTable.row.add(["DPR", "69-001", convertDate(Date()), "Shaniqua Jones"]).draw(false);
            }
            
            // Increase view by 25
            $('#button-view-increase').on('click', function() {
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByKey().startAt(document.getElementById("view-search-last").value).limitToFirst(25).once('value').then(function(snapshot) {
                    var i = 0;
                    snapshot.forEach(function(childSnapshot){
                        if(i!=0){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                        }
                    });
                    document.getElementById("view-viewing").innerText = (dataTable.rows().count()) + " Most Recent";
                    dataTable.order([0, 'dec']).draw();
                });
            });
            
            // Increase view for searched
            // Increase for Report Type
            $('#button-view-increase-type').on('click', function() {
                firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report').orderByChild("type").startAt(document.getElementById("view-search-last").value).endAt(document.getElementById("view-search-last-input").value + "\uf8ff").limitToFirst(25).once('value').then(function(snapshot) {
                    var i = 0;
                    snapshot.forEach(function(childSnapshot){
                        if(i != 0) {
                           dataTable.row.add([childSnapshot.val().short, childSnapshot.val().jobNum, convertDate(childSnapshot.val().submittedDate), childSnapshot.val().timeStart, childSnapshot.val().submittedBy, childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                        }
                        i++;
                    });
                });
                var count = document.getElementById("view-search-count");
                count.value = Number(count.value) + 25;
                document.getElementById("view-viewing").innerText = count.value + " Reports Types Searched from: " + document.getElementById("view-search-last-input").value;
            });
            
            // Increase for Job Number
            $('#button-view-increase-num').on('click', function() {
                firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report').orderByChild("jobNum").startAt(document.getElementById("view-search-last").value).endAt(document.getElementById("view-search-last-input").value + "\uf8ff").limitToFirst(25).once('value').then(function(snapshot) {
                    console.log("starting at:" + document.getElementById("view-search-last").value);
                    console.log("ending at:" + document.getElementById("view-search-last-input").value);
                    var i = 0;
                    var length = snapshot.numChildren();
                    console.log(length);
                    snapshot.forEach(function(childSnapshot){
                        if(i != 0) {
                           dataTable.row.add([childSnapshot.val().short, childSnapshot.val().jobNum, convertDate(childSnapshot.val().submittedDate), childSnapshot.val().timeStart, childSnapshot.val().submittedBy, childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                            console.log("adding: " + childSnapshot.val().jobNum);
                        }
                        i++;
                    });
                });
                var count = document.getElementById("view-search-count");
                count.value = Number(count.value) + 25;
                document.getElementById("view-viewing").innerText = count.value + " Job Numbers Searched from: " + document.getElementById("view-search-last-input").value;
            });
            
            // Increase for Submitted By
            $('#button-view-increase-by').on('click', function() {
                firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report').orderByChild("submittedBy").startAt(document.getElementById("view-search-last").value).endAt(document.getElementById("view-search-last-input").value + "\uf8ff").limitToFirst(25).once('value').then(function(snapshot) {
                    var i = 0;
                    snapshot.forEach(function(childSnapshot){
                        if(i != 0) {
                           dataTable.row.add([childSnapshot.val().short, childSnapshot.val().jobNum, convertDate(childSnapshot.val().submittedDate), childSnapshot.val().timeStart, childSnapshot.val().submittedBy, childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                        }
                        i++;
                    });
                });
                var count = document.getElementById("view-search-count");
                count.value = Number(count.value) + 25;
                document.getElementById("view-viewing").innerText = count.value + " Reports Types Searched from: " + document.getElementById("view-search-last-input").value;
            });
            
            // Close currently Viewed Report
            $('#button-view-close').on('click', function() {
                document.getElementById("view-card").setAttribute("style", "display:none");
            });
            
            // Load report data into the view on click
            // Used to be
            /* $('#view-table tbody').on( 'click', 'button', function () {
                var data = $('#view-table').DataTable().row($(this).parents('tr')).data();
            */
            var currentDataRow;
            $('#view-table tbody').on( 'click', 'tr', function () {
                var data = $('#view-table').DataTable().row($(this)).data();
                currentDataRow = $('#view-table').DataTable().row($(this));
                console.log(data);
                firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report/' + data[5]).once('value').then(function(snapshot) {
                    document.getElementById("button-view-download").onclick = function(){reportDownload(snapshot)};
                    document.getElementById("view-hidden-id").value = snapshot.key;
                    document.getElementById("view-report").innerText = snapshot.val().short;
                    document.getElementById("view-report-job-name").value = snapshot.val().jobName;
                    document.getElementById("view-report-job-num").value = snapshot.val().jobNum;
                    document.getElementById("view-report-date").value = snapshot.val().submittedDate;
                    document.getElementById("view-report-time-start").value = snapshot.val().timeStart;
                    document.getElementById("view-report-time-end").value = snapshot.val().timeEnd;
                    document.getElementById("view-report-time-total").value = snapshot.val().timeTotal;
                    document.getElementById("view-report-contractor").value = snapshot.val().contractor;
                    document.getElementById("view-report-foreman").value = snapshot.val().foreman;
                    document.getElementById("view-report-iqr").value = snapshot.val().iqr;
                    var viewList = document.getElementById("view-report-fields");
                    viewList.innerHTML = "";
                    // Load Data if Report is a DPR
                    if(snapshot.val().short=="DPR") {
                        document.getElementById("view-report-dpr-performed").innerHTML = "";
                        document.getElementById("view-report-dpr-tasks").innerHTML = "";
                        document.getElementById("view-report-dpr-lunch").innerHTML = "";
                        document.getElementById("view-report-dpr-materials").innerHTML = "";
                        document.getElementById("view-report-dpr-techs-hours").innerHTML = "";
                        document.getElementById("div-view-report-dpr").setAttribute('style', 'display:true');
                        document.getElementById("div-view-report-lunch").setAttribute('style', 'display:none');
                        var lunch = document.getElementById("view-report-dpr-techs-hours");
                        var sectionLunch = document.createElement("H6");
                        var sectionLunchText = document.createTextNode("Employee Hours");
                        // Data for DPR employees and their hours
                        var hours = document.getElementById("view-report-dpr-techs-hours");
                        var sectionTitle = document.createElement("H6");
                        var sectionTitleText = document.createTextNode("Employee Hours");
                        sectionTitle.append(sectionTitleText);
                        hours.append(sectionTitle);
                        if(snapshot.val().employees != null) {
                            for(var i=0; i < snapshot.val().employees.length; i++) {
                                var label = document.createElement("label");
                                label.id = "view-tech-label-" + i;
                                label.textContent = snapshot.val().employees[i].name;
                                var div = document.createElement("div");
                                div.id = "view-tech-hours-" + i;
                                div.className = "input-group mb-1";
                                div.innerHTML = '<span class="input-group-addon"><i class="fa fa-user"></i></span><input readonly id="view-tech-' + i + '" placeholder="Hours" class="form-control" value="' + snapshot.val().employees[i].hours + '"><input id="view-tech-id-' + i + '" style="display:none" value="' + snapshot.val().employees[i].id + '>';
                                hours.append(label);
                                hours.append(div);
                            }
                        }
                        // Data for DPR Lunch Length
                        document.getElementById("view-report-dpr-lunch").value = snapshot.val().tasks.lunch;
                        // Data for DPR Materials
                        var materials = document.getElementById("view-report-dpr-materials");
                        sectionTitle = document.createElement("H6");
                        sectionTitleText = document.createTextNode("Materials / Equipment Needed");
                        sectionTitle.append(sectionTitleText);
                        materials.append(sectionTitle);
                        if(snapshot.val().materials != null){
                            for(var i=0; i < snapshot.val().materials.length; i++) {
                                var div = document.createElement("div");
                                div.id = "view-report-dpr-materials-row-" + i;
                                div.className = "row";
                                div.innerHTML = '<div class="input-group mb-1 col-sm"><span class="input-group-addon"><i class="fa fa-shopping-basket"></i></span><input id="view-report-materials-' + i + '" placeholder="Materials Needed" readonly value="' + snapshot.val().materials[i].needed + '" class="form-control"></div><div class="input-group mb-1 col-sm"><span class="input-group-addon"><i class="fa fa-calendar"></i></span><input id="view-report-materials-date-' + i + '" type="date" placeholder="Date Needed" readonly value="' + snapshot.val().materials[i].by + '" class="form-control"></div>';
                                materials.append(div);
                            }
                        }
                        // Data for DPR Work Performed
                        var performed = document.getElementById("view-report-dpr-performed");
                        sectionTitle = document.createElement("H6");
                        sectionTitleText = document.createTextNode("Work Performed"); sectionTitle.append(sectionTitleText);
                        performed.append(sectionTitle);
                        if(snapshot.val().work != null) {
                            for(var i=0; i < snapshot.val().work.length; i++) {
                                var div = document.createElement("div");
                                div.id = "view-report-dpr-materials-row-" + i;
                                div.className = "row";
                                div.innerHTML = '<div class="col-sm mb-1"><label for="report-performed-0">Work Performed</label><div class="input-group"><span class="input-group-addon"><i class="icon-like"></i></span><input readonly id="view-report-performed-' + i + '" placeholder="Work Performed" value="' + snapshot.val().work[i].performed + '" class="form-control"></div></div><div class="col-sm mb-1"><label for="report-location-0">Location</label><div class="input-group"><span class="input-group-addon"><i class="icon-map"></i></span><input readonly id="view-report-location-' + i + '" placeholder="Location"  value="' + snapshot.val().work[i].location + '" class="form-control"></div></div>';
                                performed.append(div);
                            }
                        }
                        // Data for DPR Tasks
                        var tasks = document.getElementById("view-report-dpr-tasks");
                        sectionTitle = document.createElement("H6");
                        sectionTitleText = document.createTextNode("Tasks"); sectionTitle.append(sectionTitleText);
                        performed.append(sectionTitle);
                        if(snapshot.val().tasks != null) {
                            console.log(snapshot.val().tasks.length);
                            var i = 0;
                            while(snapshot.val().tasks[i] != null) {
                                var divA = document.createElement("div");
                                console.log("Making Tasks: " + i);
                                divA.id = "view-report-dpr-tasks-row-a-" + i;
                                divA.className = "row";
                                divA.innerHTML = '<div class="col-sm mb-1"><label for="report-tasks-' + i + '">Location</label><div class="input-group"><span class="input-group-addon"><i class="icon-globe-alt"></i></span><input readonly id="report-tasks-' + i + '" placeholder="Tasks Location" class="form-control" value="' + snapshot.val().tasks[i].location + '"></div></div><div class="col-sm mb-1"><label for="report-tr-' + i + '">TR Build Out</label><div class="input-group"><span class="input-group-addon"><i class="icon-map"></i></span><input readonly id="report-tr-' + i + '" placeholder="TR %" class="form-control" value="' + snapshot.val().tasks[i].tr + '"></div></div><div class="col-sm mb-1"><label for="report-pathways-' + i + '">Pathways</label><div class="input-group"><span class="input-group-addon"><i class="icon-equalizer"></i></span><input readonly id="report-pathways-' + i + '" type="number" placeholder="Pathways %" class="form-control" value="' + snapshot.val().tasks[i].pathways + '"></div></div>';
                                performed.append(divA);
                                var divB = document.createElement("div");
                                divB.id = "view-report-dpr-tasks-row-b-" + i;
                                divB.className = "row";
                                divB.innerHTML = '<div class="col-sm mb-1"><label for="report-roughin-' + i + '">Rough In</label><div class="input-group"><span class="input-group-addon"><i class="icon-globe-alt"></i></span><input readonly id="report-roughin-' + i + '" placeholder="Rough In %" class="form-control" value="' + snapshot.val().tasks[i].roughin + '"></div></div><div class="col-sm mb-1"><label for="report-terminations-' + i + '">Terminations</label><div class="input-group"><span class="input-group-addon"><i class="icon-map"></i></span><input readonly id="report-terminations-' + i + '" placeholder="Terminations %" class="form-control" value="' + snapshot.val().tasks[i].terminations + '"></div></div><div class="col-sm mb-1"><label for="report-testing-' + i + '">Testing</label><div class="input-group"><span class="input-group-addon"><i class="icon-equalizer"></i></span><input readonly id="report-testing-' + i + '" type="number" placeholder="Testing %" class="form-control" value="' + snapshot.val().tasks[i].testing + '"></div></div>';
                                performed.append(divB);
                                i++;
                            }
                        }
                    }
                    // Non-DPR Reports
                    else {
                        document.getElementById("div-view-report-dpr").setAttribute('style', 'display:none');
                        if(snapshot.val().lunch != null) {
                            
                            document.getElementById("div-view-report-lunch").setAttribute('style', 'display:inline');
                            document.getElementById("view-report-lunch").value = snapshot.val().lunch;
                        }
                        else document.getElementById("div-view-report-lunch").setAttribute('style', 'display:none');
                        for(var i=0; i<snapshot.val().list.length; i++) {
                            if(snapshot.val().list[i].type != null) {
                                switch(snapshot.val().list[i].type) {
                                    case "title":
                                        var h5 = document.createElement("H5");
                                        var h5Text = document.createTextNode(snapshot.val().list[i].work);
                                        h5.append(h5Text);
                                        viewList.append(h5);
                                        break;
                                    case "costCode":
                                    case "costCodeFillable":
                                        var reportRowA = document.createElement("div");
                                        reportRowA.className = "row";
                                        var reportRowB = document.createElement("div");
                                        reportRowB.className = "row";
                                        var reportRowC = document.createElement("div");
                                        reportRowC.className = "row";
                                        var reportColA = document.createElement("div");
                                        reportColA.className = "col";
                                        reportColA.innerText = snapshot.val().list[i].work;
                                        reportColA.id = "report-" + i;
                                        var reportColB = document.createElement("div");
                                        reportColB.className = "col";
                                        reportColB.innerText = "Cost Code: " + snapshot.val().list[i].code;
                                        reportColB.value = snapshot.val().list[i].code;
                                        reportColB.id = "report-code-" + i;
                                        var reportColC = document.createElement("div");
                                        reportColC.className = "col";
                                        reportColC.innerText = "Hours";
                                        var reportColD = document.createElement("div");
                                        reportColD.className = "col";
                                        reportColD.innerText = "Overtime Hours";
                                        var reportColE = document.createElement("div");
                                        reportColE.className = "col";
                                        reportColE.innerText = "Issued Materials";
                                        var reportColF = document.createElement("div");
                                        reportColF.className = "col";
                                        reportColF.innerText = "Installed Materials";
                                        reportRowA.append(reportColA);
                                        reportRowA.append(reportColB);
                                        reportRowB.append(reportColC);
                                        reportRowB.append(reportColD);
                                        reportRowB.append(reportColE);
                                        reportRowB.append(reportColF);
                                        var reportColG = document.createElement("div");
                                        reportColG.className = "col-6 col-md-3 mb-1";
                                        var reportColH = document.createElement("div");
                                        reportColH.className = "col-6 col-md-3 mb-1";
                                        var reportColI = document.createElement("div");
                                        reportColI.className = "col-6 col-md-3 mb-1";
                                        var reportColJ = document.createElement("div");
                                        reportColJ.className = "col-6 col-md-3 mb-1";
                                        var reportInputA = document.createElement("input");
                                        reportInputA.className = "form-control";
                                        reportInputA.id = "report-hours-" + i;
                                        reportInputA.type = "number";
                                        reportInputA.placeholder = "Hours";
                                        reportInputA.readOnly = true;
                                        reportInputA.value = snapshot.val().list[i].hours;
                                        reportColG.append(reportInputA);
                                        var reportInputB = document.createElement("input");
                                        reportInputB.className = "form-control";
                                        reportInputB.id = "report-ot-" + i;
                                        reportInputB.type = "number";
                                        reportInputB.placeholder = "Overtime Hours";
                                        reportInputB.readOnly = true;
                                        reportInputB.value = snapshot.val().list[i].ot;
                                        reportColH.append(reportInputB);
                                        var reportInputC = document.createElement("input");
                                        reportInputC.className = "form-control";
                                        reportInputC.id = "report-issued-" + i;
                                        reportInputC.type = "text";
                                        reportInputC.placeholder = "Issued Materials";
                                        reportInputC.readOnly = true;
                                        reportInputC.value = snapshot.val().list[i].issued;
                                        reportColI.append(reportInputC);
                                        var reportInputD = document.createElement("input");
                                        reportInputD.className = "form-control";
                                        reportInputD.id = "report-installed-" + i;
                                        reportInputD.type = "text";
                                        reportInputD.placeholder = "Installed Materials";
                                        reportInputD.readOnly = true;
                                        reportInputD.value = snapshot.val().list[i].installed;
                                        reportColJ.append(reportInputD);
                                        reportRowC.append(reportColG);
                                        reportRowC.append(reportColH);
                                        reportRowC.append(reportColI);
                                        reportRowC.append(reportColJ);
                                         if(localStorage["WYDuserUnused"] == "false") {
                                            if(reportInputA.value == "" && reportInputB.value == "" && reportInputC.value == "" && reportInputD.value == "") {
                                                console.log("Trying to hide");
                                                reportRowA.style.display = "none";
                                                reportRowB.style.display = "none";
                                                reportRowC.style.display = "none";
                                            }
                                        }
                                        viewList.append(reportRowA);
                                        viewList.append(reportRowB);
                                        viewList.append(reportRowC);
                                        break;
                                }
                            }
                            else {
                                if(snapshot.val().list[i].title == true) {
                                    var h5 = document.createElement("H5");
                                    var h5Text = document.createTextNode(snapshot.val().list[i].work);
                                    h5.append(h5Text);
                                    viewList.append(h5);
                                }
                                else {
                                    var reportRowA = document.createElement("div");
                                    reportRowA.className = "row";
                                    var reportRowB = document.createElement("div");
                                    reportRowB.className = "row";
                                    var reportRowC = document.createElement("div");
                                    reportRowC.className = "row";
                                    var reportColA = document.createElement("div");
                                    reportColA.className = "col";
                                    reportColA.innerText = snapshot.val().list[i].work;
                                    reportColA.id = "report-" + i;
                                    var reportColB = document.createElement("div");
                                    reportColB.className = "col";
                                    reportColB.innerText = "Cost Code: " + snapshot.val().list[i].code;
                                    reportColB.value = snapshot.val().list[i].code;
                                    reportColB.id = "report-code-" + i;
                                    var reportColC = document.createElement("div");
                                    reportColC.className = "col";
                                    reportColC.innerText = "Hours";
                                    var reportColD = document.createElement("div");
                                    reportColD.className = "col";
                                    reportColD.innerText = "Overtime Hours";
                                    var reportColE = document.createElement("div");
                                    reportColE.className = "col";
                                    reportColE.innerText = "Issued Materials";
                                    var reportColF = document.createElement("div");
                                    reportColF.className = "col";
                                    reportColF.innerText = "Installed Materials";
                                    reportRowA.append(reportColA);
                                    reportRowA.append(reportColB);
                                    reportRowB.append(reportColC);
                                    reportRowB.append(reportColD);
                                    reportRowB.append(reportColE);
                                    reportRowB.append(reportColF);
                                    var reportColG = document.createElement("div");
                                    reportColG.className = "col-6 col-md-3 mb-1";
                                    var reportColH = document.createElement("div");
                                    reportColH.className = "col-6 col-md-3 mb-1";
                                    var reportColI = document.createElement("div");
                                    reportColI.className = "col-6 col-md-3 mb-1";
                                    var reportColJ = document.createElement("div");
                                    reportColJ.className = "col-6 col-md-3 mb-1";
                                    var reportInputA = document.createElement("input");
                                    reportInputA.className = "form-control";
                                    reportInputA.id = "report-hours-" + i;
                                    reportInputA.type = "number";
                                    reportInputA.placeholder = "Hours";
                                    reportInputA.readOnly = true;
                                    reportInputA.value = snapshot.val().list[i].hours;
                                    reportColG.append(reportInputA);
                                    var reportInputB = document.createElement("input");
                                    reportInputB.className = "form-control";
                                    reportInputB.id = "report-ot-" + i;
                                    reportInputB.type = "number";
                                    reportInputB.placeholder = "Overtime Hours";
                                    reportInputB.readOnly = true;
                                    reportInputB.value = snapshot.val().list[i].ot;
                                    reportColH.append(reportInputB);
                                    var reportInputC = document.createElement("input");
                                    reportInputC.className = "form-control";
                                    reportInputC.id = "report-issued-" + i;
                                    reportInputC.type = "text";
                                    reportInputC.placeholder = "Issued Materials";
                                    reportInputC.readOnly = true;
                                    reportInputC.value = snapshot.val().list[i].issued;
                                    reportColI.append(reportInputC);
                                    var reportInputD = document.createElement("input");
                                    reportInputD.className = "form-control";
                                    reportInputD.id = "report-installed-" + i;
                                    reportInputD.type = "text";
                                    reportInputD.placeholder = "Installed Materials";
                                    reportInputD.readOnly = true;
                                    reportInputD.value = snapshot.val().list[i].installed;
                                    reportColJ.append(reportInputD);
                                    reportRowC.append(reportColG);
                                    reportRowC.append(reportColH);
                                    reportRowC.append(reportColI);
                                    reportRowC.append(reportColJ);
                                     if(localStorage["WYDuserUnused"] == "false") {
                                        if(reportInputA.value == "" && reportInputB.value == "" && reportInputC.value == "" && reportInputD.value == "") {
                                            console.log("Trying to hide");
                                            reportRowA.style.display = "none";
                                            reportRowB.style.display = "none";
                                            reportRowC.style.display = "none";
                                        }
                                    }
                                    viewList.append(reportRowA);
                                    viewList.append(reportRowB);
                                    viewList.append(reportRowC);

                                }
                            }
                        }
                    }
                });
                document.getElementById("view-card").setAttribute("style", "display:true");
            } );
            
            // Custom Search Buttons
            // Report Type
            $('#button-search-type').on('click', function() {
                var search = document.getElementById("view-search");
                document.getElementById("view-search-count").value = 100;
                document.getElementById("view-search-last-input").value = search.value;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByChild("type").startAt(search.value).endAt(search.value + "\uf8ff").limitToFirst(100).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Reports Types Searched from: " + search.value;
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            // Job Number
            $('#button-search-num').on('click', function() {
                var search = document.getElementById("view-search");
                document.getElementById("view-search-count").value = 100;
                document.getElementById("view-search-last-input").value = search.value;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByChild("jobNum").startAt(search.value).endAt(search.value + "\uf8ff").limitToFirst(100).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Job Numbers Searched from: " + search.value;
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            // Submitted By
            $('#button-search-by').on('click', function() {
                var search = document.getElementById("view-search");
                document.getElementById("view-search-count").value = 100;
                document.getElementById("view-search-last-input").value = search.value;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByChild("submittedBy").startAt(search.value).endAt(search.value + "\uf8ff").limitToFirst(100).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Submitted By: " + search.value;
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            // Submitted Date
            $('#button-search-date-submitted').on('click', function() {
                var search = document.getElementById("input-search-date");
                var searchShort = search.value.split(" ");
                var searchFinal;
                if(searchShort[2] < 10) searchFinal = searchShort[0] + " " + searchShort[1] + " 0" + searchShort[2] + " " + searchShort[3];
                else searchFinal = search.value;
                console.log(searchFinal);
                console.log(new Date(searchFinal));
                document.getElementById("view-search-count").value = 100;
                document.getElementById("view-search-last-input").value = searchFinal;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByChild("submittedDate").startAt(searchFinal).endAt(searchFinal + "\uf8ff").limitToFirst(100).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Submitted On: " + searchFinal;
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            // Report Date
            $('#button-search-date-report').on('click', function() {
                var search = document.getElementById("input-search-date-alt");
                console.log(search.value);
                console.log(Date(search.value));
                document.getElementById("view-search-count").value = 100;
                document.getElementById("view-search-last-input").value = search.value;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByChild("timeStart").startAt(search.value).endAt(search.value + "\uf8ff").limitToFirst(100).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Reports For: " + search.value;
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            // Back to Default
            $('#button-search-normal').on('click', function() {
                var search = document.getElementById("view-search");
                document.getElementById("view-search-count").value = 25;
                dataTable.clear()
                    .draw();
                firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history').orderByKey().limitToFirst(25).once('value').then(function(snapshot) {
                    snapshot.forEach(function(childSnapshot){
                            dataTable.row.add([ childSnapshot.val().timeStart, childSnapshot.val().type, childSnapshot.val().jobNum, childSnapshot.val().date, localStorage["WYDuserNameFull"], childSnapshot.key]).draw();
                            document.getElementById("view-search-last").value = childSnapshot.key;
                    });
                    document.getElementById("view-viewing").innerText = dataTable.rows().count() + " Most Recent";
                    dataTable.order([0, 'dec']).draw();
                });
                document.getElementById("button-view-increase").setAttribute("style", "display:true");
                document.getElementById("button-view-increase-type").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-num").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-date").setAttribute("style", "display:none");
                document.getElementById("button-view-increase-by").setAttribute("style", "display:none");
            });
            
            $('#input-search-date').datepicker({
                dateFormat: "D M d yy",
                showOtherMonths: true,
                selectOtherMonths: true
            })
                .change(function() {
                    $('#input-search-date-alt').val(moment($(this).val()).format('MM/DD/Y'));
                });
            
            $('#button-view-delete').on('click', function() {
                var confirmDelete = confirm("Are You Sure You Would Like To Delete This Report?");
                if(confirmDelete) {
                    firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report/' + document.getElementById("view-hidden-id").value + '/submittedUID').once('value').then(function(snapshot) {
                        firebase.database().ref('user/' + localStorage["WYDuserID"] + '/history/' + document.getElementById("view-hidden-id").value).remove();
                        var deleteVal = document.getElementById("view-hidden-id").value;
                        firebase.database().ref('company/' + localStorage["WYDuserCompanyID"] + '/report/' + document.getElementById("view-hidden-id").value).remove().then(function() {
                            toastr["info"](deleteVal + " Report has successfully been deleted!");
                            currentDataRow.remove().draw();
                            $('#button-view-close').trigger('click');
                        });
                    });
                }
            });
        });
    </script>
    
    <!-- Make sure user is logged in, else send to login -->
    <script>
        firebase.auth().onAuthStateChanged(function(user) {
          if (user) {
            // User is signed in.
            //toastr["info"]("user logged in");
            if(localStorage["WYDuserID"]!=user.uid || localStorage["WYDuserAccess"]==null) getUserData();
          } else {
            // No user is signed in.
            window.location="login.html";
            //toastr["warning"]("User Not Logged In!");
          }
        });
    </script>

</body>

</html>